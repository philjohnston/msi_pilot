---
title: "Pilot_Analysis"
author: "Phillip Johnston"
date: "November 7, 2018"
output: html_document
---

```{r}
library(tidyverse)
library(ggplot2)
library(data.table)

setwd("C:/Users/Phil/Projects/msi/msi_pilot/data")

df = read_csv("1a_sub990.csv") %>% 
  data.table() %>% 
  filter(resp != "NaN")

sub = df$subj[1]
```

```{r plot proportions}
ggplot(df, aes(x=factor(SOA), fill = factor(resp))) + 
  geom_bar(position = "fill") + 
  labs(x = "SOA", y = "Proportion", title = sub, fill = "Judgment") +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r plot synchrony freqs by SOA}
df %>% 
  group_by(SOA, resp) %>% 
  summarise(n = n()) %>% 
  mutate(freq = n / sum(n)) %>% 
  filter(resp == 'right') %>% 
  
  ggplot(aes(x = SOA, y = freq)) + 
    geom_point() +
    labs(x = "SOA", y = "Frequency")
```

```{r plot mean rt by SOA}
df %>% group_by(SOA) %>% 
  summarise(mean = mean(rt)) %>% 
  
  ggplot(aes(x = SOA, y = mean)) + 
    geom_point() +
    labs(x = "SOA (ms)", y = "Mean RT (s)")
```

